(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[250],{9790:function(e,t,n){"use strict";var r=n(3203);t.Z=void 0;var a=r(n(9124)),i=n(4246),o=(0,a.default)((0,i.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"}),"Print");t.Z=o},7917:function(e,t,n){"use strict";var r=n(3203);t.Z=void 0;var a=r(n(9124)),i=n(4246),o=(0,a.default)((0,i.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.Z=o},8853:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/invoice",function(){return n(5359)}])},8992:function(e,t,n){"use strict";var r=n(4246),a=n(309),i=n(6538);let o=e=>{let{children:t,mb:n}=e;return(0,r.jsx)(a.Z,{style:{overflow:"hidden"},children:(0,r.jsx)(i.Z,{my:"32px",mb:n,children:t})})};t.Z=o},9446:function(e,t,n){"use strict";var r=n(4246),a=n(6538);let i=e=>{let{children:t}=e;return(0,r.jsx)(a.Z,{display:"flex",flexDirection:"row-reverse",gap:"8px",children:t})};t.Z=i},188:function(e,t,n){"use strict";var r=n(4246);n(7378);var a=n(9894),i=n.n(a),o=n(8038),l=n.n(o),c=n(7545),s=n(2384),d=n(2133),u=n(2750),h=n(8666),v=n(1434),p=n(6538);let m=e=>{let{children:t,title:n,prev:a}=e,o="物件管理システム",m=void 0===n?o:"".concat(n," - ").concat(o);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{children:[(0,r.jsx)("title",{children:m}),(0,r.jsx)("meta",{charSet:"utf-8"}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,r.jsx)(c.Z,{position:"sticky",children:(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(d.Z,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},LinkComponent:i(),href:null!=a?a:"",disabled:void 0===a,children:(0,r.jsx)(v.Z,{})}),(0,r.jsx)(u.Z,{variant:"h6",component:"h1",flexGrow:1,children:null!=n?n:o}),(0,r.jsx)(p.Z,{display:"flex",flexGrow:0,children:[{title:"トップ",href:"/"},{title:"物件一覧",href:"/apartment"},{title:"入居状況",href:"/room"},{title:"レシート発行",href:"/invoice"}].map(e=>(0,r.jsx)(h.Z,{sx:{my:2,color:"white",display:"block"},LinkComponent:i(),href:e.href,children:e.title},e.href))})]})}),t]})};t.Z=m},5817:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(4246),a=n(6233);function i(){return(0,r.jsx)(a.Z,{})}},4366:function(e,t,n){"use strict";n.d(t,{M:function(){return i}});var r=n(4246),a=n(6677);let i=e=>()=>{let t;let n=e.layout,i=e.page;if(e.query){let{query:o,isReady:l}=(0,a.useRouter)();if(!l)return(0,r.jsx)(n,{query:void 0});t=e.query.parse(o)}return(0,r.jsx)(n,{query:t,children:(0,r.jsx)(i,{query:t})})}},5359:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return es}});var r=n(4246),a=n(5670),i=n(5705),o=n(3049),l=n(8238),c=n(2222),s=n(4447),d=n(808),u=n(5773),h=n(7378),v=n(8944),p=n(2267),m=n(7818),x=n(1640),Z=n(2709),f=n(9780),j=n(6683),g=n(3659),b=n(4124),k=n(6749);function C(e){return(0,k.Z)("PrivateSwitchBase",e)}(0,b.Z)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);let w=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],y=e=>{let{classes:t,checked:n,disabled:r,edge:a}=e,i={root:["root",n&&"checked",r&&"disabled",a&&`edge${(0,x.Z)(a)}`],input:["input"]};return(0,p.Z)(i,C,t)},z=(0,Z.ZP)(g.Z)(({ownerState:e})=>(0,u.Z)({padding:9,borderRadius:"50%"},"start"===e.edge&&{marginLeft:"small"===e.size?-3:-12},"end"===e.edge&&{marginRight:"small"===e.size?-3:-12})),S=(0,Z.ZP)("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),M=h.forwardRef(function(e,t){let{autoFocus:n,checked:a,checkedIcon:i,className:o,defaultChecked:l,disabled:c,disableFocusRipple:s=!1,edge:h=!1,icon:p,id:m,inputProps:x,inputRef:Z,name:g,onBlur:b,onChange:k,onFocus:C,readOnly:M,required:B,tabIndex:P,type:I,value:O}=e,R=(0,d.Z)(e,w),[E,F]=(0,f.Z)({controlled:a,default:Boolean(l),name:"SwitchBase",state:"checked"}),N=(0,j.Z)(),_=e=>{C&&C(e),N&&N.onFocus&&N.onFocus(e)},H=e=>{b&&b(e),N&&N.onBlur&&N.onBlur(e)},V=e=>{if(e.nativeEvent.defaultPrevented)return;let t=e.target.checked;F(t),k&&k(e,t)},q=c;N&&void 0===q&&(q=N.disabled);let L=(0,u.Z)({},e,{checked:E,disabled:q,disableFocusRipple:s,edge:h}),Y=y(L);return(0,r.jsxs)(z,(0,u.Z)({component:"span",className:(0,v.Z)(Y.root,o),centerRipple:!0,focusRipple:!s,disabled:q,tabIndex:null,role:void 0,onFocus:_,onBlur:H,ownerState:L,ref:t},R,{children:[(0,r.jsx)(S,(0,u.Z)({autoFocus:n,checked:a,defaultChecked:l,className:Y.input,disabled:q,id:("checkbox"===I||"radio"===I)&&m,name:g,onChange:V,readOnly:M,ref:Z,required:B,ownerState:L,tabIndex:P,type:I},"checkbox"===I&&void 0===O?{}:{value:O},x)),E?i:p]}))});var B=n(6576),P=(0,B.Z)((0,r.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),I=(0,B.Z)((0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),O=(0,B.Z)((0,r.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),R=n(8014);function E(e){return(0,k.Z)("MuiCheckbox",e)}let F=(0,b.Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]),N=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],_=e=>{let{classes:t,indeterminate:n,color:r}=e,a={root:["root",n&&"indeterminate",`color${(0,x.Z)(r)}`]},i=(0,p.Z)(a,E,t);return(0,u.Z)({},t,i)},H=(0,Z.ZP)(M,{shouldForwardProp:e=>(0,Z.FO)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,"default"!==n.color&&t[`color${(0,x.Z)(n.color)}`]]}})(({theme:e,ownerState:t})=>(0,u.Z)({color:(e.vars||e).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${"default"===t.color?e.vars.palette.action.activeChannel:e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,m.Fq)("default"===t.color?e.palette.action.active:e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==t.color&&{[`&.${F.checked}, &.${F.indeterminate}`]:{color:(e.vars||e).palette[t.color].main},[`&.${F.disabled}`]:{color:(e.vars||e).palette.action.disabled}})),V=(0,r.jsx)(I,{}),q=(0,r.jsx)(P,{}),L=(0,r.jsx)(O,{}),Y=h.forwardRef(function(e,t){var n,a;let i=(0,R.Z)({props:e,name:"MuiCheckbox"}),{checkedIcon:o=V,color:l="primary",icon:c=q,indeterminate:s=!1,indeterminateIcon:p=L,inputProps:m,size:x="medium",className:Z}=i,f=(0,d.Z)(i,N),j=s?p:c,g=s?p:o,b=(0,u.Z)({},i,{color:l,indeterminate:s,size:x}),k=_(b);return(0,r.jsx)(H,(0,u.Z)({type:"checkbox",inputProps:(0,u.Z)({"data-indeterminate":s},m),icon:h.cloneElement(j,{fontSize:null!=(n=j.props.fontSize)?n:x}),checkedIcon:h.cloneElement(g,{fontSize:null!=(a=g.props.fontSize)?a:x}),ownerState:b,ref:t,className:(0,v.Z)(k.root,Z)},f,{classes:k}))});var $=n(8196),D=n(9073),T=n(8785),G=n(2750),W=n(8666),X=n(188),Q=n(6538),U=n(9790),A=n(8784),J=n(473),K=n(8992),ee=n(4366),et=n(5817),en=n(9446),er=n(7693),ea=n.n(er),ei=n(7917),eo=n(2668),el=n(6677);let ec=e=>{var t,n;let{tenants:d,defaultChecks:u,month:v,onChangeMonth:p,onSave:m,onPrint:x}=e,[Z,f]=(0,h.useState)(u),j=e=>Boolean(Z[e]),g=(0,h.useMemo)(()=>d.map(e=>{var t,n,r,a,i,o,l,c,s,d;let u=null!==(t=e.invoices[0])&&void 0!==t?t:void 0,h=e.room,v=e.room.apartment;return{id:null!==(n=null==u?void 0:u.id)&&void 0!==n?n:null,tenantId:e.id,rent:String(null!==(o=null!==(i=null!==(a=null!==(r=null==u?void 0:u.rent)&&void 0!==r?r:e.rent)&&void 0!==a?a:h.rent)&&void 0!==i?i:v.rent)&&void 0!==o?o:"0"),waterCharge:String(null!==(d=null!==(s=null!==(c=null!==(l=null==u?void 0:u.waterCharge)&&void 0!==l?l:e.waterCharge)&&void 0!==c?c:h.waterCharge)&&void 0!==s?s:v.waterCharge)&&void 0!==d?d:"0")}}),[d,v]),[b,k]=(0,h.useState)(g),C=(e,t,n)=>k(r=>{let a=[...r];return a[e]={...a[e],[t]:n(a[e][t])},a}),w=e=>t=>C(e,"rent",()=>t.target.value),y=e=>()=>C(e,"rent",t=>""===t.trim()?g[e].rent:t),z=e=>t=>C(e,"waterCharge",()=>t.target.value),S=e=>()=>C(e,"waterCharge",t=>""===t.trim()?g[e].waterCharge:t),M=e=>{f(t=>({...t,[e]:Boolean(!t[e])}))},B=Object.values(Z),P=B.every(e=>e),I=B.some(e=>e),O=B.every(e=>!e),R=()=>{P||I?f(e=>(0,A.mapValues)(e,()=>!1)):f(e=>(0,A.mapValues)(e,()=>!0))},E=e=>{p(()=>e.target.value)},F=()=>b.map(e=>({...e,rent:null!==(t=(0,eo.zb)(e.rent))&&void 0!==t?t:0,waterCharge:null!==(n=(0,eo.zb)(e.waterCharge))&&void 0!==n?n:0})),N=async e=>{let t=e.currentTarget;await m(F()),V(t)},_=()=>x(F(),Object.keys(Z)),[H,V]=(0,h.useState)(null),q=()=>V(null),L=Boolean(H);return(0,r.jsxs)(K.Z,{children:[(0,r.jsx)(en.Z,{children:(0,r.jsx)(a.Z,{type:"month",value:v,onChange:E})}),(0,r.jsx)(i.Z,{children:(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(l.Z,{children:(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(s.Z,{padding:"checkbox",children:(0,r.jsx)(Y,{checked:P,indeterminate:!P&&I,onChange:R})}),(0,r.jsx)(s.Z,{children:"アパート"}),(0,r.jsx)(s.Z,{children:"部屋"}),(0,r.jsx)(s.Z,{children:"契約者"}),(0,r.jsx)(s.Z,{children:"家賃"}),(0,r.jsx)(s.Z,{children:"水道料金"})]})}),(0,r.jsx)($.Z,{children:d.map((e,t)=>(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(s.Z,{padding:"checkbox",children:(0,r.jsx)(Y,{checked:j(e.id),onChange:()=>M(e.id)})}),(0,r.jsx)(s.Z,{children:e.room.apartment.name}),(0,r.jsx)(s.Z,{children:e.room.name}),(0,r.jsx)(s.Z,{children:e.name}),(0,r.jsxs)(s.Z,{padding:"none",children:[(0,r.jsx)(D.Z,{type:"number",value:b[t].rent,onChange:w(t),onBlur:y(t)}),"円"]}),(0,r.jsxs)(s.Z,{padding:"none",children:[(0,r.jsx)(D.Z,{type:"number",value:b[t].waterCharge,onChange:z(t),onBlur:S(t)}),"円"]})]},e.id))})]})}),(0,r.jsxs)(Q.Z,{position:"fixed",bottom:"16px",right:"16px",children:[(0,r.jsx)(T.ZP,{open:L,anchorEl:H,onClose:q,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:(0,r.jsx)(G.Z,{sx:{p:2},children:"保存しました"})}),(0,r.jsx)(W.Z,{variant:"contained",endIcon:(0,r.jsx)(ei.Z,{}),onClick:N,children:"保存"}),(0,r.jsx)(W.Z,{variant:"contained",endIcon:(0,r.jsx)(U.Z,{}),onClick:_,disabled:O,children:"印刷"})]})]})};var es=(0,ee.M)({layout:e=>{let{children:t}=e;return(0,r.jsx)(X.Z,{title:"レシート発行",prev:"/",children:t})},page:()=>{let e=(0,el.useRouter)(),t=J.W.useContext(),n=(0,h.useMemo)(()=>ea()().format("YYYY-MM"),[]),[a,i]=(0,h.useState)(n),o=(0,h.useMemo)(()=>{let e=ea()(a);return{year:e.year(),month:e.month()+1}},[a]),{data:l,isLoading:c}=J.W.tenant.listOccupying.useQuery(o),s=l?Object.fromEntries(l.map(e=>[e.id,!0])):void 0,d=async e=>{await J.L.invoice.update.mutate({month:a,invoices:e}),t.invalidate()},u=async(t,n)=>{let r=new URLSearchParams({tenantIds:n.join(",")});await J.L.invoice.update.mutate({month:a,invoices:t}),e.push("/invoice/preview/".concat(a,"?").concat(r.toString()))};return l&&s&&!c?(0,r.jsx)(ec,{tenants:l,defaultChecks:s,month:a,onChangeMonth:i,onSave:d,onPrint:u},a):(0,r.jsx)(et.Z,{})}})},2668:function(e,t,n){"use strict";n.d(t,{OE:function(){return c},di:function(){return i},zb:function(){return o},zf:function(){return l}});var r=n(7693),a=n.n(r);let i=e=>e||0===e?String(e):"",o=e=>{let t=Number.parseFloat(e);return Number.isInteger(t)?t:null},l=e=>null===e?null:a()(e).format("YYYY-MM-DD"),c=e=>null===e?null:a()(e).toDate()}},function(e){e.O(0,[33,933,55,132,472,774,888,179],function(){return e(e.s=8853)}),_N_E=e.O()}]);